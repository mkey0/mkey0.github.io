<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>docker | Mkey的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="dockerdocker 概念解决环境配置的问题，将运行环境打包发布。 虚拟化、容器化！">
<meta property="og:type" content="article">
<meta property="og:title" content="docker">
<meta property="og:url" content="https://monkeyh0ck.github.io/2021/10/01/docker/index.html">
<meta property="og:site_name" content="Mkey的博客">
<meta property="og:description" content="dockerdocker 概念解决环境配置的问题，将运行环境打包发布。 虚拟化、容器化！">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://monkeyh0ck.github.io/2021/10/01/docker/work/note/docker/image-20210610125533543.png">
<meta property="og:image" content="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg2018.cnblogs.com%2Fblog%2F1488757%2F201902%2F1488757-20190213230940998-2124455805.png&refer=http%3A%2F%2Fimg2018.cnblogs.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1625892999&t=9dba81a3a32e90cda65d5d0b8d398902">
<meta property="article:published_time" content="2021-09-30T16:00:00.000Z">
<meta property="article:modified_time" content="2023-03-26T13:29:05.164Z">
<meta property="article:author" content="HOU">
<meta property="article:tag" content="web-security">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://monkeyh0ck.github.io/2021/10/01/docker/work/note/docker/image-20210610125533543.png">
  
    <link rel="alternate" href="/atom.xml" title="Mkey的博客" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Mkey的博客</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://monkeyh0ck.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-docker" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/10/01/docker/" class="article-date">
  <time class="dt-published" datetime="2021-09-30T16:00:00.000Z" itemprop="datePublished">2021-10-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      docker
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="docker"><a href="#docker" class="headerlink" title="docker"></a>docker</h1><h2 id="docker-概念"><a href="#docker-概念" class="headerlink" title="docker 概念"></a>docker 概念</h2><p>解决环境配置的问题，将运行环境打包发布。</p>
<p>虚拟化、容器化！</p>
<span id="more"></span>

<p><strong>隔离</strong>：核心思想</p>
<p>开发语言：Go</p>
<p>官网：<a target="_blank" rel="noopener" href="https://www.docker.com/">Empowering App Development for Developers | Docker</a></p>
<p>dockerhub：<a target="_blank" rel="noopener" href="https://registry.hub.docker.com/">Docker Hub</a></p>
<p>虚拟机技术缺点：</p>
<ol>
<li>资源占用多</li>
<li>步骤多</li>
<li>启动慢</li>
</ol>
<p>容器化技术：不是完整的操作系统</p>
<p>容器没有内核，直接运行在宿主机内核中。每个容器相互隔离，互不影响。</p>
<h4 id="DevOps"><a href="#DevOps" class="headerlink" title="DevOps"></a>DevOps</h4><p><strong>应用快速部署！</strong>使用docker一键运行。</p>
<p><strong>更便捷的升级和扩容</strong></p>
<p><strong>更高效的计算资源利用</strong></p>
<p><strong>更简单的系统运维</strong></p>
<h2 id="docker-安装"><a href="#docker-安装" class="headerlink" title="docker 安装"></a>docker 安装</h2><h4 id="docker-基本组成"><a href="#docker-基本组成" class="headerlink" title="docker 基本组成"></a>docker 基本组成</h4><ol>
<li>镜像（image）：docker镜像就是一个模板，通过镜像可以创建多个容器。</li>
<li>容器（container）：docker利用容器技术，独立运行应用，通过镜像创建，相当于一个简易linux系统</li>
<li>仓库（repository）：存放镜像的地方</li>
</ol>
<h4 id="安装-docker"><a href="#安装-docker" class="headerlink" title="安装 docker"></a>安装 docker</h4><p>安装步骤：</p>
<pre><code>1.	卸载旧版本
2.	需要的安装包
3.	设置镜像仓库
4.	跟新软件包索引
5.	安装docker
6.	启动docker：systemctl start docker
</code></pre>
<p>卸载步骤：</p>
<pre><code>1. 卸载软件
2. 删除资源：rm -rf /var/lib/docker
</code></pre>
<h2 id="docker原理"><a href="#docker原理" class="headerlink" title="docker原理"></a>docker原理</h2><h4 id="docker比VM快的原因"><a href="#docker比VM快的原因" class="headerlink" title="docker比VM快的原因"></a>docker比VM快的原因</h4><ol>
<li>docker比虚拟机又更少的抽象层</li>
<li>docker利用的是宿主机的内核，vm需要是guest os，省略了复杂过程</li>
</ol>
<h2 id="docker-常用命令"><a href="#docker-常用命令" class="headerlink" title="docker 常用命令"></a>docker 常用命令</h2><h4 id="帮助命令"><a href="#帮助命令" class="headerlink" title="帮助命令"></a>帮助命令</h4><blockquote>
<p>docker version 		显示版本</p>
<p>docker 命令 –help	帮助命令</p>
<p>docker info				显示系统信息，包括镜像和容器的数量</p>
</blockquote>
<h4 id="镜像命令"><a href="#镜像命令" class="headerlink" title="镜像命令"></a>镜像命令</h4><blockquote>
<p>docker images 	查看镜像地址</p>
<p>docker search 	  搜索镜像</p>
<p>docker pull 			下载镜像</p>
<p>docker rmi -f 容器id			删除镜像</p>
</blockquote>
<h4 id="容器命令"><a href="#容器命令" class="headerlink" title="容器命令"></a>容器命令</h4><blockquote>
<p>docker run image	运行</p>
<p>-d 					后台方式运行</p>
<p>-it					使用交互模式</p>
<p>-p 宿主机端口：容器端口					指定容器端口</p>
<p>–name			命名</p>
<p>exit					停止并退出容器</p>
<p>ctrl+P+Q  		退出容器、容器不停止</p>
<p>docker ps 		列出正在运行的容器</p>
<p>-a 					正在运行的同期+带出历史运行过的容器</p>
<p>-n&#x3D;？				最近创建的容器</p>
<p>docker rm 容器id		删除容器，不能删除正在运行的</p>
<p>docker rm -f 容器id 	强制删除容器</p>
<p>docker start 容器id	开启</p>
<p>docker restart 容器id	重启</p>
<p>docker stop 容器id	停止正在运行的容器</p>
<p>docker kill 容器id		强制停止正在运行的容器</p>
</blockquote>
<h4 id="其他命令"><a href="#其他命令" class="headerlink" title="其他命令"></a>其他命令</h4><blockquote>
<p>docker run -d 容器id 		后台运行</p>
<p>当没有前台的程序时，后台程序没有提供服务，则立即结束</p>
<p>docker logs -f -t 容器id	查看容器日志</p>
<p>docker top 容器id 	查看容器运行id</p>
<p>docker inspect 容器id	查看容器源数据</p>
</blockquote>
<h4 id="进入当前正在运行的容器"><a href="#进入当前正在运行的容器" class="headerlink" title="进入当前正在运行的容器"></a>进入当前正在运行的容器</h4><blockquote>
<p>#方式一</p>
<p>docker exec -it  容器id  bashShell(&#x2F;bin&#x2F;bash)	新命令行</p>
<p>#方式二</p>
<p>docker attach 容器id				进入正在运行的命令行</p>
</blockquote>
<h4 id="从容器内拷贝文件"><a href="#从容器内拷贝文件" class="headerlink" title="从容器内拷贝文件"></a>从容器内拷贝文件</h4><blockquote>
<p>docker cp 容器id：容器内路径   目的的主机路径</p>
</blockquote>
<p><em>阿里云镜像都是最小可运行环境</em></p>
<blockquote>
<p>docker status 		查看cpu状态</p>
</blockquote>
<h2 id="可视化"><a href="#可视化" class="headerlink" title="可视化"></a>可视化</h2><ul>
<li>portainer</li>
<li>rancher</li>
</ul>
<h4 id="commit镜像"><a href="#commit镜像" class="headerlink" title="commit镜像"></a>commit镜像</h4><blockquote>
<p>docker commit 提交容器成为一个新副本</p>
<p>docker commit -m&#x3D;”提交的描述信息” -a&#x3D;”作者” 容器id 目标镜像名</p>
</blockquote>
<h2 id="容器数据卷"><a href="#容器数据卷" class="headerlink" title="容器数据卷"></a>容器数据卷</h2><h4 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h4><p>数据存储在容器中，一旦容器删除，数据也随之丢失</p>
<p><strong>需求：数据持久化，存储在容器外。</strong></p>
<p><strong>卷技术</strong>：容器间数据共享技术！</p>
<ul>
<li>容器持久化和同步操作</li>
<li>容器间数据共享</li>
</ul>
<h4 id="使用数据卷（volume）"><a href="#使用数据卷（volume）" class="headerlink" title="使用数据卷（volume）"></a>使用数据卷（volume）</h4><blockquote>
<p>方式一： -v 	直接用命令挂载</p>
<p>指定路径挂载</p>
<p>-v 宿主机地址:容器地址</p>
<p>匿名挂载</p>
<p>-v 容器内路径</p>
<p>具名挂载</p>
<p>-v 卷名:容器内路径</p>
</blockquote>
<p>好处：只需在本地修改即可，容器内自动同步</p>
<p>扩展：设置权限</p>
<p>-v 容器内路径:ro&#x2F;rw</p>
<p>ro	readonly		这个路径只能由宿主机操作，容器内无法操作</p>
<p>rw	readwrite</p>
<blockquote>
<p>–volumes-from   实现数据共享</p>
<p>文件被删后也能实现数据共享，是要有使用该文件的存在就不会真正删除</p>
</blockquote>
<p><strong>结论</strong></p>
<ul>
<li>数据卷的生命周期一直持续到没有容器使用为止</li>
<li>一旦持久化到本地，本地的数据是不会删除的</li>
</ul>
<h2 id="DockerFile"><a href="#DockerFile" class="headerlink" title="DockerFile"></a>DockerFile</h2><h4 id="DockerFile-介绍"><a href="#DockerFile-介绍" class="headerlink" title="DockerFile 介绍"></a>DockerFile 介绍</h4><p>dockerfile 是用来构建docker镜像的文件！命令参数脚本！</p>
<h4 id="DockerFile构建过程"><a href="#DockerFile构建过程" class="headerlink" title="DockerFile构建过程"></a>DockerFile构建过程</h4><p><strong>基础知识：</strong></p>
<ol>
<li>每个保留关键字（指令）都必须是大写字母</li>
<li>执行从上到下顺序执行</li>
<li>&#x2F;# 表示注释</li>
<li>每一个指令都会创建一个新的镜像层，并提交</li>
</ol>
<p>dockerfile是面向开发的 </p>
<p>步骤：开发、部署、运行</p>
<p>DockerFile:构建文件，定义了一切的步骤，源代码</p>
<p>DockerImages:通过DockerFile构建生成的镜像，最终发布和运行的产品</p>
<p>Docker容器：容器就是镜像运行起来提供服务器</p>
<h4 id="DockerFile的指令"><a href="#DockerFile的指令" class="headerlink" title="DockerFile的指令"></a>DockerFile的指令</h4><p>FROM						# 基础镜像</p>
<p>MAINTAINER			# 镜像是谁写的，姓名+邮箱</p>
<p>RUN							# 镜像构建的时候需要运行的命令</p>
<p>ADD							# 步骤、tomcat镜像、这个tomcat压缩包！添加内容</p>
<p>WORKDIR					# 镜像的工作目录</p>
<p>VOLUME					# 挂载的目录</p>
<p>EXPOST						# 保留端口配置</p>
<p>CMD							# 指定这个容器启动的时候要运行的命令，只有最后一个会生效，可被替代</p>
<p>ENTRYPOINT			# 指定这个容器启动的时候要运行的命令，可以追加命令</p>
<p>ONBUILD					# 当构建一个被继承DockerFile这个时候就会运行ONBUILD指令，触发指令</p>
<p>COPY						# 类似ADD，将我们的文件拷贝到镜像中</p>
<p>ENV							# 构建的时候设置环境变量</p>
<blockquote>
<p>scrach   		# 最基础的镜像</p>
<p>CMD [“ls”,”-a”]	运行CMD命令   当docker run 命令运行时在后面追加命令时会替换掉CMD原本的命令</p>
<p>ENTRYPOINT [“ls”,”-a”]	运行CMD命令   当docker run 命令运行时在后面追加命令时会在CMD原本的命令后面追加命令</p>
</blockquote>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p><img src="/2021/10/01/docker/work\note\docker\image-20210610125533543.png" alt="image-20210610125533543"></p>
<p><img src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg2018.cnblogs.com%2Fblog%2F1488757%2F201902%2F1488757-20190213230940998-2124455805.png&refer=http%3A%2F%2Fimg2018.cnblogs.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1625892999&t=9dba81a3a32e90cda65d5d0b8d398902" alt="img"></p>
<h3 id="docker-网络"><a href="#docker-网络" class="headerlink" title="docker 网络"></a>docker 网络</h3><ul>
<li>容器之间可以互相ping 通</li>
<li>evth-pair 是一队的虚拟设备接口，成对出现、一段连接协议，一段彼此相连</li>
<li>evth-pair 充当桥梁，连接各种虚拟网络</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://monkeyh0ck.github.io/2021/10/01/docker/" data-id="clkp7xfcd000rr0v5bn2e89nt" data-title="docker" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web-security/" rel="tag">web-security</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2021/10/01/NAT/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">前一篇</strong>
      <div class="article-nav-title">
        
          NAT
        
      </div>
    </a>
  
  
    <a href="/2021/10/01/xiaodi1/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">后一篇</strong>
      <div class="article-nav-title">小迪安全</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web-security/" rel="tag">web-security</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/ctf/" style="font-size: 10px;">ctf</a> <a href="/tags/web-security/" style="font-size: 20px;">web-security</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/07/">七月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">六月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">三月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">二月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">一月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">十二月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">十一月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">十月 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/07/29/BUUCTF-web-%E7%AC%AC%E5%9B%9B%E5%91%A8/">BUUCTF-web-第四周</a>
          </li>
        
          <li>
            <a href="/2023/07/22/BUUCTF-web-%E7%AC%AC%E4%B8%89%E5%91%A8/">BUUCTF-web-第三周</a>
          </li>
        
          <li>
            <a href="/2023/07/14/BUUCTF-web-%E7%AC%AC%E4%BA%8C%E5%91%A8/">BUUCTF-web-第二周</a>
          </li>
        
          <li>
            <a href="/2023/07/09/BUUCTF-web-%E7%AC%AC%E4%B8%80%E5%91%A8/">BUUCTF-web-第一周</a>
          </li>
        
          <li>
            <a href="/2022/06/01/%E5%8F%8D%E5%BC%B9shell/">反弹shell</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2023 HOU<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>